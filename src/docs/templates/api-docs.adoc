= CareCode API 문서
:toc: left
:toclevels: 3
:sectnums:
:source-highlighter: highlightjs
:icons: font

== 개요

CareCode API는 육아 정보 플랫폼을 위한 RESTful API입니다.

=== 기본 정보

* **Base URL**: `http://13.209.36.209:8081`
* **API 버전**: v1
* **인증**: JWT Bearer Token

== 인증

=== JWT 토큰

API 요청 시 Authorization 헤더에 JWT 토큰을 포함해야 합니다:

[source,http]
----
Authorization: Bearer <your-jwt-token>
----

== API 엔드포인트

=== 사용자 관리

==== 로그인
[source,http]
----
POST /auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password"
}
----

==== 회원가입
[source,http]
----
POST /auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "password",
  "name": "사용자명"
}
----

=== 육아시설

==== 시설 목록 조회
[source,http]
----
GET /api/facilities?page=0&size=10
Authorization: Bearer <token>
----

==== 시설 상세 조회
[source,http]
----
GET /api/facilities/{id}
Authorization: Bearer <token>
----

=== 커뮤니티

==== 게시글 목록
[source,http]
----
GET /api/community/posts?page=0&size=10
Authorization: Bearer <token>
----

==== 게시글 작성
[source,http]
----
POST /api/community/posts
Authorization: Bearer <token>
Content-Type: application/json

{
  "title": "제목",
  "content": "내용",
  "category": "GENERAL"
}
----

=== 건강관리

==== 건강기록 조회
[source,http]
----
GET /api/health/records?childId={childId}
Authorization: Bearer <token>
----

==== 건강기록 등록
[source,http]
----
POST /api/health/records
Authorization: Bearer <token>
Content-Type: multipart/form-data

{
  "childId": 1,
  "recordType": "VACCINATION",
  "title": "예방접종",
  "description": "접종 내용",
  "recordDate": "2024-01-15"
}
----

=== 정책정보

==== 정책 목록
[source,http]
----
GET /api/policies?category=EDUCATION&page=0&size=10
Authorization: Bearer <token>
----

==== 정책 상세
[source,http]
----
GET /api/policies/{id}
Authorization: Bearer <token>
----

=== 챗봇

==== 채팅 시작
[source,http]
----
POST /api/chatbot/sessions
Authorization: Bearer <token>
Content-Type: application/json

{
  "message": "안녕하세요"
}
----

==== 메시지 전송
[source,http]
----
POST /api/chatbot/sessions/{sessionId}/messages
Authorization: Bearer <token>
Content-Type: application/json

{
  "message": "육아 시설 추천해주세요"
}
----

== 응답 코드

|코드|설명|
|---|---|
|200|성공|
|201|생성됨|
|400|잘못된 요청|
|401|인증 실패|
|403|권한 없음|
|404|찾을 수 없음|
|500|서버 오류|

== 에러 응답

[source,json]
----
{
  "timestamp": "2024-01-15T10:30:00",
  "status": 400,
  "error": "Bad Request",
  "message": "잘못된 요청입니다",
  "path": "/api/facilities"
}
----

== 데이터 모델

=== 사용자 (User)

[source,json]
----
{
  "id": 1,
  "email": "user@example.com",
  "name": "사용자명",
  "role": "USER",
  "createdAt": "2024-01-15T10:30:00",
  "updatedAt": "2024-01-15T10:30:00"
}
----

=== 육아시설 (CareFacility)

[source,json]
----
{
  "id": 1,
  "name": "행복한 어린이집",
  "address": "서울시 강남구",
  "phone": "02-1234-5678",
  "capacity": 50,
  "currentCount": 30,
  "rating": 4.5,
  "facilityType": "KINDERGARTEN"
}
----

=== 게시글 (Post)

[source,json]
----
{
  "id": 1,
  "title": "육아 팁 공유",
  "content": "육아에 도움이 되는 팁입니다",
  "author": {
    "id": 1,
    "name": "사용자명"
  },
  "category": "GENERAL",
  "createdAt": "2024-01-15T10:30:00",
  "viewCount": 10,
  "likeCount": 5
}
----

== 개발 환경 설정

=== 로컬 개발

1. 애플리케이션 실행:
   ```bash
   ./gradlew bootRun
   ```

2. Swagger UI 접속:
   ```
   http://13.209.36.209:8081/swagger-ui.html
   ```

3. API 문서 생성:
   ```bash
   ./gradlew generateApiDocs
   ```

=== 테스트

API 테스트는 Postman이나 curl을 사용할 수 있습니다:

[source,bash]
----
# 로그인
curl -X POST http://13.209.36.209:8081/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'

# 토큰으로 API 호출
curl -X GET http://13.209.36.209:8081/api/facilities \
  -H "Authorization: Bearer <your-token>"
----
